{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/aviru/.vscode/Every%20Project%20is%20Here/Linktree%20clon/link-tree/app/api/senddata/route.js"],"sourcesContent":["\"use server\"\r\n\r\nimport clientPromise from \"@/lib/mongodb\";\r\n\r\n  export const fetchuser = async (Username) => {\r\n    const clint = await clientPromise;\r\n    const db = clint.db(\"Linktree\");\r\n    const collection = db.collection(\"Links\");\r\n\r\n    const doc  = await collection.findOne({username: Username})\r\n\r\n    if(!doc){\r\n      return JSON.parse(JSON.stringify({success:'false', error:'true', message: 'username nor exist', result: null }))\r\n   \r\n    }\r\n    else{\r\n      return JSON.parse(JSON.stringify({success:'true', error:'false', message: 'user found', result: doc }))\r\n    }\r\n}\r\n\r\nexport const fetchloginuser = async (Username) => {\r\n    const clint = await clientPromise;\r\n    const db = clint.db(\"Linktree\");\r\n    const collection = db.collection(\"Login\");\r\n\r\n    const doc  = await collection.findOne({username: Username})\r\n\r\n    if(!doc){\r\n      return JSON.parse(JSON.stringify({success:'false', error:'true', message: 'username nor exist', result: null }))\r\n   \r\n    }\r\n    else{\r\n      return JSON.parse(JSON.stringify({success:'true', error:'false', message: 'user found', result: doc }))\r\n    }\r\n}"],"names":[],"mappings":";;;;;;IAIe;IAgBF","debugId":null}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/aviru/.vscode/Every%20Project%20is%20Here/Linktree%20clon/link-tree/app/generate/page.js"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport { fetchuser, fetchloginuser } from \"../api/senddata/route\";\r\nimport { useSession } from \"next-auth/react\";\r\nimport { useSearchParams } from \"next/navigation\";\r\n\r\nconst Generate = () => {\r\n  const { data: session } = useSession();\r\n  const usehParams = useSearchParams();\r\n  const router = useRouter();\r\n\r\n  // Initialize username with an empty string to avoid hydration mismatch\r\n  const [username, setusername] = useState(\"\"); // Empty string to avoid mismatch\r\n  const [bio, setbio] = useState(\"\");\r\n  const [addlinks, setaddlinks] = useState([{ link: \"\", text: \"\" }]);\r\n  const [handel, sethandel] = useState(usehParams.get(\"handel\"));\r\n  const [ppic, setppic] = useState(\"\");\r\n\r\n  // Update username once the session data is available\r\n  useEffect(() => {\r\n    if (session?.user?.name) {\r\n      fetchData();\r\n    }\r\n  }, [session]);\r\n\r\n  const fetchData = async () => {\r\n    const response = await fetchuser(session?.user?.name);\r\n    const loginresponse = await fetchloginuser(session?.user?.name);\r\n    if (loginresponse.success === \"true\") {\r\n      setusername(loginresponse.result.username);\r\n    }\r\n    if (response.success === \"true\") {\r\n      setbio(response.result.bio);\r\n      setaddlinks(response.result.links);\r\n      setppic(response.result.profilepic);\r\n      sethandel(response.result.handel);\r\n    }\r\n    // else {\r\n    //   toast.error(\"Error fetching user data\");\r\n    // }\r\n  };\r\n\r\n  const handleChange = (index, link, text) => {\r\n    setaddlinks((initialLinks) =>\r\n      initialLinks.map((item, i) => {\r\n        if (i === index) {\r\n          return { link, text };\r\n        } else {\r\n          return item;\r\n        }\r\n      })\r\n    );\r\n  };\r\n\r\n  const addLinks = () => {\r\n    setaddlinks(addlinks.concat([{ text: \"\", link: \"\" }]));\r\n  };\r\n\r\n  const submitLinks = async () => {\r\n    try {\r\n      const response = await fetch(\"/api/update\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          username: username,\r\n          bio: bio,\r\n          profilepic: ppic,\r\n          links: addlinks,\r\n          handel: handel,\r\n        }),\r\n      });\r\n\r\n      const result = await response.json();\r\n      if (result.success) {\r\n        toast.success(result.message);\r\n        setTimeout(() => {\r\n          router.replace(\"/\" + username);\r\n        }, 2000);\r\n      } else {\r\n        toast.error(result.message);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error updating profile:\", error);\r\n      toast.error(\"Failed to update profile\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <section className=\"bg-purple-300 min-h-[100vh] py-6\">\r\n        <div className=\"h-[650px] w-full md:w-3xl mx-auto px-4\">\r\n          <h1 className=\"text-center text-black py-7 text-4xl font-bold\">\r\n            Edit your profile\r\n          </h1>\r\n          <div className=\"h-[500px] custom-scrollbar overflow-auto\">\r\n            <div className=\"flex flex-col gap-1 mb-9\">\r\n              <label className=\"text-black font-bold mx-3\" htmlFor=\"\">\r\n                Step 1: Username\r\n              </label>\r\n              <input\r\n                className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                value={username || \"\"}\r\n                onChange={(e) => setusername(e.target.value)}\r\n                disabled\r\n                type=\"text\"\r\n                placeholder=\"Enter your username\"\r\n              />\r\n            </div>\r\n            <div className=\"flex flex-col gap-1 mb-9\">\r\n              <label className=\"text-black font-bold mx-3\" htmlFor=\"\">\r\n                Step 2: Name\r\n              </label>\r\n              <input\r\n                className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                value={handel || \"\"}\r\n                onChange={(e) => sethandel(e.target.value)}\r\n                type=\"text\"\r\n                placeholder=\"Enter your name\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex flex-col gap-1 mb-9\">\r\n              <label className=\"text-black font-bold mx-3\" htmlFor=\"\">\r\n                Step 3: Add Links\r\n              </label>\r\n              {addlinks &&\r\n                addlinks.map((item, index) => {\r\n                  return (\r\n                    <div className=\"flex gap-1.5 mb-4\" key={index}>\r\n                      <input\r\n                        className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                        value={item.text || \"\"}\r\n                        onChange={(e) =>\r\n                          handleChange(index, item.link, e.target.value)\r\n                        }\r\n                        type=\"text\"\r\n                        placeholder=\"Site Name\"\r\n                      />\r\n                      <input\r\n                        className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                        value={item.link || \"\"}\r\n                        onChange={(e) =>\r\n                          handleChange(index, e.target.value, item.text)\r\n                        }\r\n                        type=\"text\"\r\n                        placeholder=\"Site Link\"\r\n                      />\r\n                    </div>\r\n                  );\r\n                })}\r\n              <button\r\n                onClick={() => addLinks()}\r\n                className=\"bg-gray-800 hover:bg-gray-700 py-2 px-7 mx-auto cursor-pointer text-white rounded-2xl\"\r\n              >\r\n                + Add more Links\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col gap-1 mb-9\">\r\n              <label className=\"text-black font-bold mx-3\" htmlFor=\"\">\r\n                Step 4: Profile Picture\r\n              </label>\r\n              <input\r\n                className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                value={ppic || \"\"}\r\n                onChange={(e) => setppic(e.target.value)}\r\n                type=\"text\"\r\n                placeholder=\"Enter your profile picture URL\"\r\n              />\r\n            </div>\r\n            <div className=\"flex flex-col gap-1 mb-9\">\r\n              <label className=\"text-black font-bold mx-3\" htmlFor=\"\">\r\n                Step 5: Bio\r\n              </label>\r\n              <input\r\n                className=\"bg-white text-black w-full rounded-2xl px-7 py-2\"\r\n                value={bio || \"\"}\r\n                onChange={(e) => setbio(e.target.value)}\r\n                type=\"text\"\r\n                placeholder=\"Enter your bio\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"w-full flex justify-center\">\r\n          <button\r\n            disabled={ppic === \"\" || handel === \"\" || username === \"\" || bio === \"\"}\r\n            className=\"bg-gray-800 disabled:bg-slate-700 hover:bg-gray-700 fixed bottom-10 py-2 px-7 text-lg mx-auto cursor-pointer text-white rounded-2xl\"\r\n            onClick={submitLinks}\r\n          >\r\n            Save Profile\r\n          </button>\r\n        </div>\r\n        <ToastContainer />\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Generate;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}